

<% trees.each do |tree| %>
  <h1> <%= tree.id %> </h1>

  <% tree.tabs.each do |tab| %>

    <% if tab.parent.nil? %>
      <div class="trunk" id="root">
        <h3 class="btn leaf"><%= link_to tab.name, tab.url %>
          <sup><%= link_to ">", edit_tab_path(tab), class: 'btn sub-edit' %></sup>
          <div>
            <span> <%= link_to "+", new_tab_path(parent_tab_id: tab.id), class: 'btn sub-add' %></span>
            <span> <%= link_to "x", tab_path(tab), method: :delete, data: { confirm: 'Are you sure you want to delete this note?'}, class: 'btn sub-del' %></span>
          </div>
        </h3>

        <div class="big-block">

          <% tab.children.each do |child| %>
              <div class="branch">
                <h3 class="btn leaf"><%= link_to child.name, child.url %>
                  <sup><%= link_to ">", edit_tab_path(child, parent_tab_id: child.parent_tab_id), class: 'btn sub-edit' %></sup>
                  <div>
                    <span> <%= link_to "+", new_tab_path(parent_tab_id: child.id), class: 'btn sub-add' %></span>
                    <span> <%= link_to "x", tab_path(child), method: :delete, data: { confirm: 'Are you sure you want to delete this note?'}, class: 'btn sub-del' %></span>
                  </div>
                </h3>

                  <% ########### Recursion! ##### %>

                  <%= render( partial: 'rechild', locals: { children: child.children }) if child %>

                  <% ########### /Recursion! ##### %>
              </div>
          <% end %>

        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
